<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>G√©n√©rateur HyperPlanning</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        
        .json-input {
            width: 100%;
            height: 200px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            resize: vertical;
            margin-bottom: 20px;
        }
        
        .controls {
            text-align: center;
            margin-bottom: 30px;
        }
        
        button {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            margin: 0 10px;
            font-size: 1em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,123,255,0.3);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,123,255,0.4);
        }
        
        .output {
            border: 2px solid #ddd;
            border-radius: 8px;
            min-height: 400px;
            background: white;
            margin-top: 20px;
        }
        
        /* Styles pour l'emploi du temps g√©n√©r√© */
        .emploi-du-temps {
            background: #f8f9fa;
            padding: 40px;
            font-family: Arial, sans-serif;
        }
        
        .emploi-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 20px 30px;
            border-radius: 10px;
        }
        
        .emploi-title {
            font-size: 28px;
            font-weight: bold;
            margin: 0;
        }
        
        .emploi-date {
            font-size: 18px;
            font-weight: normal;
        }
        
        .emploi-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .emploi-table th {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 15px 12px;
            text-align: left;
            font-weight: bold;
            font-size: 16px;
            border: none;
        }
        
        .emploi-table td {
            padding: 15px 12px;
            border-bottom: 1px solid #e9ecef;
            vertical-align: top;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .emploi-table tr:hover {
            background-color: #f8f9fa;
        }
        
        .emploi-table tr:nth-child(even) {
            background-color: #ffffff;
        }
        
        .emploi-table tr:nth-child(odd) {
            background-color: #f8f9fa;
        }
        
        .horaire-cell {
            font-weight: bold;
            color: #2c3e50;
            width: 10%;
            text-align: center;
        }
        
        .salle-cell {
            font-weight: bold;
            color: #3498db;
            width: 12%;
        }
        
        .matiere-cell {
            font-weight: bold;
            color: #2c3e50;
            width: 25%;
        }
        
        .enseignant-cell {
            color: #34495e;
            width: 18%;
        }
        
        .public-cell {
            color: #7f8c8d;
            font-size: 13px;
            width: 35%;
        }
        
        .error {
            color: #e74c3c;
            background: #fdf2f2;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e74c3c;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéì G√©n√©rateur d'Emploi du Temps HyperPlanning</h1>
            <p>Collez les donn√©es JSON de l'API HyperPlanning pour g√©n√©rer l'emploi du temps avec le style original</p>
        </div>
        
        <div>
            <h3>üìã Donn√©es JSON de l'API HyperPlanning :</h3>
            <textarea id="jsonInput" class="json-input" placeholder="Collez ici le JSON de votre r√©ponse d'API HyperPlanning...">
{
    "parametres": {
        "date": {
            "_T": 7,
            "V": "10/09/2025 16:40:28"
        },
        "placeParHeure": 4,
        "nomEtablissement": "EMPLOI DU TEMPS ",
        "listeLangues": {
            "_T": 24,
            "V": [
                {
                    "langID": 1036,
                    "description": "Fran√ßais"
                }
            ]
        },
        "langID": 1036,
        "nomPage": "<<Date>> <<Heure>>",
        "baliseDate": "<<Date>>",
        "baliseHeure": "<<Heure>>",
        "intervalleDefilement": 10,
        "theme": 2,
        "texteFonce": 1,
        "coefPolice": 100
    },
    "ordreContenus": [
        {
            "G": 9,
            "L": "Horaires"
        },
        {
            "G": 3,
            "L": "Salle"
        },
        {
            "G": 0,
            "L": "Mati√®re"
        },
        {
            "G": 1,
            "L": "Enseignant"
        },
        {
            "G": 2,
            "L": "Public"
        }
    ],
    "listeMessages": {
        "_T": 24,
        "V": []
    },
    "listeCours": [
        {
            "labelAnnule": "Annul√©",
            "deb": "13h30",
            "fin": "17h00",
            "place": 114,
            "duree": 14,
            "mat": "UX/UI accessibilit√© num√©rique",
            "pub": [
                "MDS - M1 DEV TITRE 7 MANAGER DE PROJET WEB ET DIGITAL"
            ],
            "prof": [
                "BEN AMOR Imed"
            ],
            "sal": [
                "TEAMS F"
            ]
        },
        {
            "labelAnnule": "Annul√©",
            "deb": "13h30",
            "fin": "17h00",
            "place": 114,
            "duree": 14,
            "mat": "UX research",
            "pub": [
                "MDS - M1 UX TITRE 7 MANAGER DE PROJET WEB ET DIGITAL"
            ],
            "prof": [
                "HAMIL Fatima"
            ],
            "sal": [
                "TEAMS G"
            ]
        },
        {
            "labelAnnule": "Annul√©",
            "deb": "13h30",
            "fin": "17h00",
            "place": 114,
            "duree": 14,
            "mat": "Culture du design graphique",
            "pub": [
                "MDS - B3 CN TITRE 6 DESIGNER GRAPHIQUE PRINT & DIGITAL"
            ],
            "prof": [
                "JOUAN No√©mie"
            ],
            "sal": [
                "TEAMS M"
            ]
        },
        {
            "labelAnnule": "Annul√©",
            "deb": "13h30",
            "fin": "17h00",
            "place": 114,
            "duree": 14,
            "mat": "Workshop Crazy Dev",
            "pub": [
                "MDS - B3 DEV TITRE 6 CONCEPTEUR DEVELOPPEUR D'APPLICATIONS"
            ],
            "prof": [
                "LEDOUX C√©cile"
            ],
            "sal": [
                "TEAMS B"
            ]
        },
        {
            "labelAnnule": "Annul√©",
            "deb": "13h30",
            "fin": "17h00",
            "place": 114,
            "duree": 14,
            "mat": "Workshop Design thinking",
            "pub": [
                "MDS - B3 WEB TITRE 6 CONCEPTEUR WEBDESIGNER"
            ],
            "prof": [
                "BLUMBERG Olivier"
            ],
            "sal": [
                "TEAMS C"
            ]
        },
        {
            "labelAnnule": "Annul√©",
            "deb": "13h30",
            "fin": "17h00",
            "place": 114,
            "duree": 14,
            "mat": "Workshop Strat d'acquisition",
            "pub": [
                "MDS - B3 WMSM TITRE 6 RESPONSABLE MARKETING ET COMMUNICATION"
            ],
            "prof": [
                "MOUSSAOUI Farida"
            ],
            "sal": [
                "TEAMS D"
            ]
        }
    ]
}</textarea>
        </div>
        
        <div class="controls">
            <button onclick="generateSchedule()">üé® G√©n√©rer l'Emploi du Temps</button>
            <button onclick="downloadHTML()">üíæ T√©l√©charger HTML</button>
            <button onclick="clearOutput()">üóëÔ∏è Effacer</button>
        </div>
        
        <div id="output" class="output">
            <div style="padding: 40px; text-align: center; color: #666;">
                <h3>üëÜ Cliquez sur "G√©n√©rer l'Emploi du Temps" pour voir le r√©sultat</h3>
                <p>L'emploi du temps sera affich√© ici avec le style original HyperPlanning</p>
            </div>
        </div>
    </div>

    <script>
        let generatedHTML = '';

        function generateSchedule() {
            try {
                const jsonInput = document.getElementById('jsonInput').value.trim();
                const data = JSON.parse(jsonInput);
                
                console.log('Donn√©es parsed:', data);
                
                // Extraire les informations
                const etablissement = data.parametres.nomEtablissement || "EMPLOI DU TEMPS";
                const dateInfo = data.parametres.date.V || new Date().toLocaleDateString('fr-FR');
                const cours = data.listeCours || [];
                const ordreContenus = data.ordreContenus || [];
                
                // Formater la date
                const dateObj = new Date(dateInfo);
                const options = { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                };
                const dateFormatted = dateObj.toLocaleDateString('fr-FR', options);
                const timeFormatted = dateObj.toLocaleTimeString('fr-FR', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                // Cr√©er le HTML de l'emploi du temps
                let scheduleHTML = `
                <div class="emploi-du-temps">
                    <div class="emploi-header">
                        <div class="emploi-title">${etablissement}</div>
                        <div class="emploi-date">${dateFormatted.charAt(0).toUpperCase() + dateFormatted.slice(1)} ${timeFormatted}</div>
                    </div>
                    
                    <table class="emploi-table">
                        <thead>
                            <tr>`;
                
                // En-t√™tes de colonnes bas√©s sur ordreContenus
                ordreContenus.forEach(col => {
                    scheduleHTML += `<th>${col.L}</th>`;
                });
                
                scheduleHTML += `
                            </tr>
                        </thead>
                        <tbody>`;
                
                // Lignes de cours
                cours.forEach(coursItem => {
                    scheduleHTML += `<tr>`;
                    
                    ordreContenus.forEach(col => {
                        let cellContent = '';
                        let cellClass = '';
                        
                        switch(col.G) {
                            case 9: // Horaires
                                cellContent = `${coursItem.deb}<br>${coursItem.fin}`;
                                cellClass = 'horaire-cell';
                                break;
                            case 3: // Salle
                                cellContent = coursItem.sal ? coursItem.sal.join(', ') : '';
                                cellClass = 'salle-cell';
                                break;
                            case 0: // Mati√®re
                                cellContent = coursItem.mat || '';
                                cellClass = 'matiere-cell';
                                break;
                            case 1: // Enseignant
                                cellContent = coursItem.prof ? coursItem.prof.join(', ') : '';
                                cellClass = 'enseignant-cell';
                                break;
                            case 2: // Public
                                cellContent = coursItem.pub ? coursItem.pub.join(', ') : '';
                                cellClass = 'public-cell';
                                break;
                            default:
                                cellContent = '';
                        }
                        
                        scheduleHTML += `<td class="${cellClass}">${cellContent}</td>`;
                    });
                    
                    scheduleHTML += `</tr>`;
                });
                
                scheduleHTML += `
                        </tbody>
                    </table>
                </div>`;
                // G√©n√©rer les lignes de cours dans le bon format
                let coursRows = '';
                cours.forEach((coursItem, index) => {
                    const bgColor = index % 2 === 0 ? '#003354' : '#004b7b';
                    coursRows += `
                    <tr class="data-row" style="background-color: ${bgColor}; color: #ffffff;">
                        <td class="col-horaires">${coursItem.deb}<br>${coursItem.fin}</td>
                        <td class="col-salle">${coursItem.sal ? coursItem.sal.join(', ') : ''}</td>
                        <td class="col-matiere">${coursItem.mat || ''}</td>
                        <td class="col-enseignant">${coursItem.prof ? coursItem.prof.join(', ') : ''}</td>
                        <td class="col-public">${coursItem.pub ? coursItem.pub.join(', ') : ''}</td>
                    </tr>`;
                });
                
                // Afficher le r√©sultat
                document.getElementById('output').innerHTML = scheduleHTML;
                generatedHTML = createFullHTML(coursRows, dateFormatted, timeFormatted);
                
                console.log('Emploi du temps g√©n√©r√© avec succ√®s');
                
            } catch (error) {
                console.error('Erreur:', error);
                document.getElementById('output').innerHTML = `
                    <div class="error">
                        <strong>‚ùå Erreur lors du parsing JSON :</strong><br>
                        ${error.message}<br><br>
                        <strong>V√©rifiez que :</strong>
                        <ul>
                            <li>Le JSON est valide (utilisez un validateur JSON en ligne)</li>
                            <li>Toutes les accolades et crochets sont bien ferm√©s</li>
                            <li>Les cha√Ænes de caract√®res sont entre guillemets</li>
                        </ul>
                    </div>`;
            }
        }
        
        function createFullHTML(scheduleContent, dateFormatted, timeFormatted) {
            return `<!DOCTYPE html>
<html lang="fr" style="overflow: hidden;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, width=device-width">
    <title>HYPERPLANNING - EMPLOI DU TEMPS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Montserrat, Arial, Verdana, Geneva, Helvetica, sans-serif;
            font-size: 11px;
            line-height: 13.2px;
            background-color: #ffffff;
            color: #000000;
            overflow: hidden;
        }
        
        .hyperplanning-content {
            width: 100%;
            height: 100vh;
        }
        
        .zone_fenetre {
            display: block;
            width: 100%;
        }
        
        .main-div {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        .panneau-information {
            display: block;
            width: 100%;
            flex: 1;
        }
        
        .panneau-wrapper {
            position: absolute;
            inset: 0px;
            font-size: 2.06em;
            background-color: #303030;
            color: #ffffff;
            font-family: Arial, Verdana, Geneva, Helvetica, sans-serif;
        }
        
        .header-table {
            font-weight: bold;
            border-collapse: collapse;
            width: 100%;
            padding: 0.5% 1%;
            font-size: 100%;
            background-color: #303030;
            color: #ffffff;
        }
        
        .header-table td {
            vertical-align: middle;
            padding: 10px;
        }
        
        .title-cell {
            text-align: left;
            width: 45%;
            font-size: 22.66px;
            font-weight: bold;
        }
        
        .page-cell {
            text-align: center;
            width: 10%;
        }
        
        .date-cell {
            text-align: right;
            width: 45%;
            font-size: 22.66px;
            font-weight: bold;
        }
        
        .data-table {
            border-collapse: collapse;
            width: 100%;
            font-size: 22.66px;
            font-family: Arial, Verdana, Geneva, Helvetica, sans-serif;
        }
        
        .header-row {
            background-color: #303030;
            color: #ffffff;
            font-size: 100%;
            height: 60px;
        }
        
        .header-row th {
            height: 60px;
            text-align: left;
            background: linear-gradient(#303030, #303030);
            padding: 15px 8px;
            font-weight: normal;
            border: none;
            font-size: 22.66px;
        }
        
        .data-row {
            font-weight: bold;
            color: #ffffff;
            height: 95px;
        }
        
        .data-row:nth-child(even) {
            background-color: #003354;
        }
        
        .data-row:nth-child(odd) {
            background-color: #004b7b;
        }
        
        .data-row td {
            font-size: 100%;
            padding: 0;
            border: none;
            vertical-align: middle;
        }
        
        .data-row td > div {
            margin: 2%;
            padding: 10px 5px;
            font-size: 22.66px;
            line-height: 27.192px;
        }
        
        .col-horaires { width: 92px; }
        .col-salle { width: 95px; }
        .col-matiere { width: 253px; }
        .col-enseignant { width: 186px; }
        .col-public { width: 589px; }
        
        @media print {
            .data-row td > div { font-size: 18px; }
        }
    </style>
</head>
<body>
    ${scheduleContent}
</body>
</html>`;
        }
        
        function downloadHTML() {
            const outputElement = document.getElementById('output');
            if (!outputElement || !outputElement.innerHTML.trim()) {
                alert('Veuillez d\'abord g√©n√©rer l\'emploi du temps !');
                return;
            }
            
            // Capturer exactement ce qui est affich√© mais avec les VRAIS styles HyperPlanning
            const displayedHTML = outputElement.innerHTML;
            
            // Cr√©er le fichier HTML avec les styles IDENTIQUES √† HyperPlanning original
            const completeHTML = `<!DOCTYPE html>
<html lang="fr" style="overflow: hidden;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0, width=device-width">
    <title>HYPERPLANNING - CAMPUS PARIS PIGIER - MY DIGITAL SCHOOL</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Montserrat, Arial, Verdana, Geneva, Helvetica, sans-serif;
            font-size: 11px;
            line-height: 13.2px;
            background-color: #303030;
            color: #ffffff;
            overflow: hidden;
        }
        
        .hyperplanning-content {
            width: 100%;
            height: 100vh;
            background-color: #303030;
        }
        
        .zone_fenetre {
            display: block;
            width: 100%;
        }
        
        .main-div {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }
        
        .panneau-information {
            display: block;
            width: 100%;
            flex: 1;
        }
        
        .panneau-wrapper {
            position: absolute;
            inset: 0px;
            font-size: 2.06em;
            background-color: #303030;
            color: #ffffff;
            font-family: Arial, Verdana, Geneva, Helvetica, sans-serif;
        }
        
        .header-table {
            font-weight: bold;
            border-collapse: collapse;
            width: 100%;
            padding: 0.5% 1%;
            font-size: 100%;
            background-color: #303030;
            color: #ffffff;
        }
        
        .header-table td {
            vertical-align: middle;
            padding: 10px;
        }
        
        .title-cell {
            text-align: left;
            width: 70%;
            font-size: 22.66px;
            font-weight: bold;
        }
        
        .date-cell {
            text-align: right;
            width: 30%;
            font-size: 22.66px;
            font-weight: bold;
        }
        
        .data-table {
            border-collapse: collapse;
            width: 100%;
            font-size: 22.66px;
            font-family: Arial, Verdana, Geneva, Helvetica, sans-serif;
        }
        
        .header-row {
            background-color: #303030;
            color: #ffffff;
            font-size: 100%;
            height: 60px;
        }
        
        .header-row th {
            height: 60px;
            text-align: left;
            background: linear-gradient(#303030, #303030);
            padding: 15px 8px;
            font-weight: normal;
            border: none;
            font-size: 22.66px;
            color: #ffffff;
        }
        
        .data-row {
            font-weight: bold;
            color: #ffffff;
            height: 95px;
        }
        
        /* Alternance exacte comme HyperPlanning */
        .data-row:nth-child(2) { background-color: #003354; } /* Premi√®re ligne de donn√©es */
        .data-row:nth-child(3) { background-color: #004b7b; } 
        .data-row:nth-child(4) { background-color: #003354; }
        .data-row:nth-child(5) { background-color: #004b7b; }
        .data-row:nth-child(6) { background-color: #003354; }
        .data-row:nth-child(7) { background-color: #004b7b; }
        .data-row:nth-child(8) { background-color: #003354; }
        
        .data-row td {
            font-size: 100%;
            padding: 0;
            border: none;
            vertical-align: middle;
            color: #ffffff;
        }
        
        .data-row td > div {
            margin: 2%;
            padding: 10px 5px;
            font-size: 22.66px;
            line-height: 27.192px;
        }
        
        .col-horaires { width: 92px; }
        .col-salle { width: 95px; }
        .col-matiere { width: 253px; }
        .col-enseignant { width: 186px; }
        .col-public { width: 589px; }
    </style>
</head>
<body>
    ${displayedHTML}
</body>
</html>`;
            
            const timestamp = new Date().toISOString().slice(0, 16).replace(/:/g, 'h').replace('T', '_');
            const filename = `emploi-du-temps-hyperplanning-${timestamp}.html`;
            
            const blob = new Blob([completeHTML], { type: 'text/html;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.style.display = 'none';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            console.log(`Fichier t√©l√©charg√©: ${filename}`);
            console.log('Le fichier utilise maintenant les styles HyperPlanning originaux');
        }
        
        function clearOutput() {
            document.getElementById('output').innerHTML = `
                <div style="padding: 40px; text-align: center; color: #666;">
                    <h3>üëÜ Cliquez sur "G√©n√©rer l'Emploi du Temps" pour voir le r√©sultat</h3>
                    <p>L'emploi du temps sera affich√© ici avec le style original HyperPlanning</p>
                </div>`;
            generatedHTML = '';
        }
        
        // G√©n√©ration automatique au chargement
        document.addEventListener('DOMContentLoaded', function() {
            generateSchedule();
        });
    </script>
</body>
</html>
